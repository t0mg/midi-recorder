<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Web MIDI Recorder</title>
    <link rel="stylesheet" href="index.css" />
    <script type="importmap">
      {
        "imports": {
          "@tonejs/midi": "https://esm.sh/@tonejs/midi@2.0.28"
        }
      }
    </script>
  </head>
  <body>
    <div id="root">
      <h1>
        Web MIDI Recorder
        <div id="midi-indicator" class="midi-indicator"></div>
      </h1>

      <div class="card">
        <button id="toggle-devices-button" class="collapsible-header" aria-expanded="false" aria-controls="device-selectors-container">
          <span id="device-settings-title">MIDI Device Settings</span>
          <span class="chevron"></span>
        </button>
        <div id="device-selectors-container" class="collapsible-content">
          <div class="control-group">
            <label for="midi-input">MIDI Input</label>
            <select id="midi-input"></select>
          </div>
          <div class="control-group">
            <label for="midi-output">MIDI Output</label>
            <select id="midi-output"></select>
          </div>
          <div class="control-group">
            <label for="output-channel">Output Channel</label>
            <select id="output-channel"></select>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="controls-grid">
          <button id="record-button" class="button-record">Record</button>
          <button id="play-button" class="button-play">Play</button>
          <button id="save-button">Save</button>
          <button id="export-button">Export MIDI</button>
          <label for="import-midi-input" class="button-like">Import MIDI</label>
          <input type="file" id="import-midi-input" accept=".mid,.midi" />
        </div>
        <div class="auto-record-control">
          <input type="checkbox" id="auto-record-checkbox" checked />
          <label for="auto-record-checkbox"
            >Auto-record on input (3s silence to save)</label
          >
        </div>
      </div>

      <div class="card" id="playback-card" style="display: none">
        <div class="playback-controls">
          <div id="time-display" class="time-display">00:00 / 00:00</div>
          <input
            type="range"
            id="playback-slider"
            class="playback-slider"
            value="0"
            min="0"
            max="100"
          />
        </div>
      </div>

      <div class="card">
        <div class="control-group">
          <label for="saved-recordings">Saved Recordings</label>
          <select id="saved-recordings"></select>
        </div>
        <div class="controls-grid">
          <button id="load-button">Load Selected</button>
          <button id="rename-button">Rename</button>
          <button id="delete-button">Delete Selected</button>
        </div>
      </div>

      <div id="status-bar" class="status-bar">Initializing...</div>
    </div>
    <script type="module" src="index.tsx"></script>
  </body>
</html>